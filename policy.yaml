# Consiglio Agent Policy Configuration
# This file defines security profiles and tool permissions

# Global defaults - safe by default
defaults:
  require_manual_confirmation: true
  max_execution_time: 300  # seconds
  rate_limit_window: 60    # seconds

# Security profiles
profiles:
  # Development profile - minimal permissions
  dev:
    description: "Development environment with minimal permissions"
    allow:
      - web.get:
          domains: ["localhost", "127.0.0.1", "example.com"]
          max_requests_per_minute: 10
          require_manual_confirmation: false
      - file.read:
          paths: ["./work", "./data", "./docs"]
          require_manual_confirmation: false
      - browser.control:
          require_manual_confirmation: true
          headless_only: true
          max_pages_per_session: 5
      - file.download:
          require_manual_confirmation: true
      - file.copy:
          require_manual_confirmation: true
      - file.move:
          require_manual_confirmation: true
      - rag.search:
          require_manual_confirmation: false
      - llm.call:
          require_manual_confirmation: false
    deny:
      - shell.exec
      - file.write
      - system.control
      - email.send

  # Research profile - web access for information gathering
  research:
    description: "Research tasks with web access and file reading"
    allow:
      - web.get:
          domains: ["*"]
          max_requests_per_minute: 20
          require_manual_confirmation: false
      - file.read:
          paths: ["./work", "./data", "./docs", "./research"]
          require_manual_confirmation: false
      - browser.control:
          require_manual_confirmation: true
          headless_only: true
      - rag.search:
          require_manual_confirmation: false
      - llm.call:
          require_manual_confirmation: false
      - file.write:
          paths: ["./work/reports", "./work/summaries"]
          require_manual_confirmation: true
    deny:
      - shell.exec
      - system.control
      - email.send

  # Admin profile - full access with confirmation
  admin:
    description: "Administrative tasks with full access and confirmation"
    allow:
      - web.get:
          domains: ["*"]
          max_requests_per_minute: 50
          require_manual_confirmation: false
      - file.read:
          paths: ["*"]
          require_manual_confirmation: false
      - file.write:
          paths: ["*"]
          require_manual_confirmation: true
      - shell.exec:
          require_manual_confirmation: true
          max_commands_per_session: 10
          allowed_commands: ["ls", "cat", "grep", "find", "echo", "head", "tail", "pwd"]
          blocked_commands: ["rm", "rmdir", "chmod", "chown", "sudo"]
      - browser.control:
          require_manual_confirmation: true
          max_pages_per_session: 10
          headless_only: true
      - rag.search:
          require_manual_confirmation: false
      - llm.call:
          require_manual_confirmation: false
      - email.send:
          require_manual_confirmation: true
          max_emails_per_hour: 10
    deny:
      - system.control

# Tool-specific configurations
tools:
  web.get:
    timeout: 30
    max_redirects: 5
    user_agent: "Consiglio-Agent/1.0"
    blocked_content_types: ["application/octet-stream", "application/x-executable"]
    
  file.read:
    max_file_size: 10485760  # 10MB
    blocked_extensions: [".exe", ".bat", ".sh", ".pyc", ".so"]
    
  file.write:
    max_file_size: 10485760  # 10MB
    backup_existing: true
    allowed_extensions: [".txt", ".md", ".json", ".yaml", ".csv", ".log"]
    
  shell.exec:
    working_directory: "./work"
    environment_whitelist: ["PATH", "HOME", "USER", "PWD"]
    max_output_size: 1048576  # 1MB
    
  browser.control:
    viewport: {"width": 1280, "height": 720}
    user_agent: "Consiglio-Agent/1.0"
    block_images: false
    block_javascript: false
    max_page_load_time: 60
    
  rag.search:
    max_results: 20
    similarity_threshold: 0.7
    max_context_length: 2000
    
  llm.call:
    max_tokens: 4000
    temperature: 0.1
    timeout: 120

# Emergency overrides (require manual activation)
emergency_overrides:
  shell.exec:
    enabled: false
    activation_phrase: "EMERGENCY_OVERRIDE_SHELL"
    max_duration: 300  # 5 minutes
    
  system.control:
    enabled: false
    activation_phrase: "EMERGENCY_OVERRIDE_SYSTEM"
    max_duration: 60   # 1 minute